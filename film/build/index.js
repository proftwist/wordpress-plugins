!function(){"use strict";const{React:e}=window,{registerBlockType:l}=window.wp.blocks,{useBlockProps:t,BlockControls:i,InspectorControls:a}=window.wp.blockEditor,{ToolbarGroup:n,Button:m,PanelBody:r,RangeControl:c,SelectControl:s,Modal:o,Dashicon:d}=window.wp.components,{__}=window.wp.i18n,{SVG:f,Path:g}=window.wp.primitives,u=e.createElement(f,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e.createElement(g,{d:"M16.375 4.5H4.625a.125.125 0 0 0-.125.125v8.254l2.859-1.54a.75.75 0 0 1 .68-.016l2.384 1.142 2.89-2.074a.75.75 0 0 1 .874 0l2.313 1.66V4.625a.125.125 0 0 0-.125-.125Zm.125 9.398-2.75-1.975-2.813 2.02a.75.75 0 0 1-.76.067l-2.444-1.17L4.5 14.583v1.792c0 .069.056.125.125.125h11.75a.125.125 0 0 0 .125-.125v-2.477ZM4.625 3C3.728 3 3 3.728 3 4.625v11.75C3 17.273 3.728 18 4.625 18h11.75c.898 0 1.625-.727 1.625-1.625V4.625C18 3.728 17.273 3 16.375 3H4.625ZM20 8v11c0 .69-.31 1-.999 1H6v1.5h13.001c1.52 0 2.499-.982 2.499-2.5V8H20Z",fillRule:"evenodd",clipRule:"evenodd"}));l("film/film-gallery",{title:__("Фотоплёнка","film"),description:__("Галерея в стиле фотоплёнки с горизонтальной прокруткой","film"),category:"media",icon:u,attributes:{images:{type:"array",default:[]},height:{type:"number",default:500},linkTo:{type:"string",default:"none"},align:{type:"string",default:"none"}},supports:{align:["wide","full"]},edit:({attributes:l,setAttributes:f})=>{const{images:g,height:u,linkTo:E,align:p}=l,y=t(),[v,h]=e.useState(!1),w=()=>{if(!wp.media)return void console.error("wp.media is not available");const e=wp.media({title:__("Выберите изображения для добавления в галерею","film"),multiple:!0,library:{type:"image"},button:{text:__("Добавить в галерею","film")}});e.on("select",function(){const l=e.state().get("selection").map(function(e){return{id:(e=e.toJSON()).id,url:e.url,alt:e.alt||"",caption:e.caption,title:e.title}}),t=[...g,...l];f({images:t})}),e.open()},k=()=>{h(!0)},C=()=>{h(!1)};return e.createElement(e.Fragment,null,e.createElement(i,null,e.createElement(n,null,g.length>0&&e.createElement(m,{icon:"edit",label:__("Редактировать галерею","film"),onClick:k}),e.createElement(m,{icon:"plus",label:__("Добавить изображения","film"),onClick:w}))),e.createElement(a,null,e.createElement(r,{title:__("Настройки фотоплёнки","film"),initialOpen:!0},e.createElement(c,{label:__("Высота плёнки","film"),value:u,onChange:e=>f({height:e}),min:100,max:1e3,step:10}),e.createElement(s,{label:__("Ссылки на изображения","film"),value:E,options:[{label:__("Без ссылки","film"),value:"none"},{label:__("Ссылка на файл","film"),value:"media"},{label:__("Страница вложения","film"),value:"attachment"}],onChange:e=>f({linkTo:e})})),g.length>0&&e.createElement(r,{title:__("Управление галереей","film"),initialOpen:!1},e.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"10px"}},e.createElement(m,{isSecondary:!0,onClick:k},__("Редактировать галерею","film")),e.createElement(m,{isSecondary:!0,onClick:w},__("Добавить изображения","film")),g.length>0&&e.createElement(m,{isDestructive:!0,onClick:()=>{confirm(__("Вы уверены, что хотите удалить все изображения из галереи?","film"))&&(f({images:[]}),h(!1))}},__("Очистить галерею","film"))))),v&&e.createElement(o,{title:__("Редактирование галереи","film"),onRequestClose:C,className:"film-gallery-editor-modal",style:{maxWidth:"800px"}},e.createElement("div",{className:"film-gallery-editor-content"},e.createElement("div",{className:"film-gallery-editor-header"},e.createElement("h2",null,__("Изображения в галерее","film")),e.createElement(m,{isPrimary:!0,onClick:w},__("Добавить в галерею","film"))),e.createElement("div",{className:"film-gallery-edit-list"},0===g.length?e.createElement("div",{className:"film-gallery-empty"},e.createElement(d,{icon:"format-gallery",size:60}),e.createElement("p",null,__("В галерее пока нет изображений","film")),e.createElement(m,{isPrimary:!0,onClick:w},__("Добавить изображения","film"))):g.map((l,t)=>e.createElement("div",{key:t,className:"film-gallery-edit-item"},e.createElement("div",{className:"film-gallery-edit-preview"},e.createElement("img",{src:l.url,alt:l.alt,className:"film-gallery-edit-image"}),e.createElement("div",{className:"film-gallery-edit-number"},t+1)),e.createElement("div",{className:"film-gallery-edit-details"},e.createElement("div",{className:"film-gallery-edit-filename"},l.url.split("/").pop()),e.createElement("div",{className:"film-gallery-edit-title"},l.title||__("Без названия","film")),e.createElement("div",{className:"film-gallery-edit-meta"},(new Date).toLocaleDateString("ru-RU")," • ","890 KB • ","2000×1413")),e.createElement("div",{className:"film-gallery-edit-actions"},e.createElement(m,{icon:"arrow-up-alt2",isSmall:!0,onClick:()=>(e=>{if(0===e)return;const l=[...g];[l[e-1],l[e]]=[l[e],l[e-1]],f({images:l})})(t),disabled:0===t,label:__("Поднять выше","film")}),e.createElement(m,{icon:"arrow-down-alt2",isSmall:!0,onClick:()=>(e=>{if(e===g.length-1)return;const l=[...g];[l[e],l[e+1]]=[l[e+1],l[e]],f({images:l})})(t),disabled:t===g.length-1,label:__("Опустить ниже","film")}),e.createElement(m,{icon:"trash",isSmall:!0,isDestructive:!0,onClick:()=>(e=>{const l=g.filter((l,t)=>t!==e);f({images:l})})(t),label:__("Удалить","film")}))))),g.length>0&&e.createElement("div",{className:"film-gallery-editor-footer"},e.createElement("div",{className:"film-gallery-stats"},__("Всего изображений:","film")," ",g.length),e.createElement("div",{className:"film-gallery-footer-actions"},e.createElement(m,{isSecondary:!0,onClick:w,style:{marginRight:"10px"}},__("Добавить ещё","film")),e.createElement(m,{isPrimary:!0,onClick:C},__("Готово","film")))))),e.createElement("div",y,e.createElement("div",{className:"film-gallery-editor",style:{height:u+"px"}},0===g.length?e.createElement("div",{className:"film-placeholder"},e.createElement("p",null,__("Добавьте изображения в фотоплёнку","film")),e.createElement(m,{isPrimary:!0,onClick:w},__("Выберите изображения","film"))):e.createElement(e.Fragment,null,e.createElement("div",{className:"film-strip"},g.map((l,t)=>e.createElement("div",{key:t,className:"film-frame"},e.createElement("img",{src:l.url,alt:l.alt})))),e.createElement("div",{className:"film-gallery-actions"},e.createElement(m,{isSecondary:!0,onClick:k,style:{marginRight:"10px"}},__("Редактировать галерею","film")),e.createElement(m,{isSecondary:!0,onClick:w},__("Добавить изображения","film")))))))},save:function(){return null}})}();