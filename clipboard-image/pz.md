# Плагин Clipboard Image

## Описание

Плагин позволяет вставлять изображения из буфера обмена прямо в редактор WordPress. Поддерживает как классический редактор TinyMCE, так и блоковый редактор Gutenberg.

## Основные возможности

- ✅ Вставка изображений из буфера обмена (скриншоты, копированные картинки)
- ✅ Поддержка JPG и PNG форматов
- ✅ Автоматическая загрузка в медиатеку WordPress
- ✅ Поддержка классического и блокового редакторов
- ✅ Локализация (готов к переводу на другие языки)
- ✅ Проверка прав пользователя
- ✅ Ограничение размера файла (максимум 5MB)
- ✅ Защита от несанкционированного доступа (nonce)

## Структура плагина

```
clipboard-image/
├── clipboard-image.php          # Основной файл плагина
├── assets/
│   └── js/
│       └── paste-handler.js     # JavaScript обработчик вставки
├── languages/
│   └── clipboard-image.pot      # Файл перевода
└── pz.md                        # Эта документация
```

## Как использовать

1. Активируйте плагин в админ-панели WordPress
2. Откройте страницу создания/редактирования поста
3. Скопируйте изображение в буфер обмена (Ctrl+C или скриншот)
4. Нажмите Ctrl+V в редакторе WordPress
5. Изображение автоматически загрузится в медиатеку и вставится в пост

## Техническая реализация

### PHP часть (clipboard-image.php)
- Класс `ClipboardImage` с методами инициализации
- Обработка AJAX запросов для загрузки изображений
- Валидация файлов и проверка прав доступа
- Загрузка файлов в медиатеку WordPress

### JavaScript часть (paste-handler.js)
- Перехват событий вставки (paste)
- Извлечение изображений из буфера обмена
- AJAX загрузка на сервер
- Вставка изображений в разные типы редакторов

### Особенности работы в Gutenberg
- В Gutenberg редакторе плагин загружает изображение в медиатеку, но не вставляет его в контент
- Это предотвращает двойную вставку, так как Gutenberg сам обрабатывает вставку изображений из буфера
- Для классического редактора плагин полностью обрабатывает вставку

## Безопасность

- Проверка nonce для защиты от CSRF атак
- Валидация типов файлов
- Проверка прав пользователя на загрузку файлов
- Ограничение размера файла

## Локализация

Плагин готов к переводу. Для добавления новой локали:
1. Создайте .po файл на основе clipboard-image.pot
2. Переведите строки
3. Скомпилируйте в .mo файл
4. Поместите файлы в папку languages/

## Автор

Владимир Бычко
Сайт: https://bychko.ru

## Лицензия

GPL v2 or later