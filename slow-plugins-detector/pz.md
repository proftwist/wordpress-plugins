# Slow Plugins Detector

Плагин для обнаружения и анализа медленных плагинов на фронтенде сайта.

## Автор

Владимир Бычко (bychko.ru)

## Функциональность

- Тестирование производительности каждого активного плагина индивидуально
- Измерение времени загрузки страницы с каждым плагином по отдельности
- Отображение результатов в виде таблицы с цветовой индикацией статуса
- Кнопки деактивации/активации плагинов прямо из таблицы результатов
- Очистка кешей перед каждым тестом для точных измерений
- AJAX-интерфейс с индикатором прогресса
- Полная поддержка локализации (русский и английский языки)

## Структура файлов

```
/slow-plugins-detector/
├── slow-plugins-detector.php     # Основной файл плагина
├── admin/
│   └── admin-page.php            # Страница админки
├── includes/
│   ├── class-test-runner.php     # Класс для выполнения тестов
│   └── class-results-table.php   # Класс для отображения результатов
├── assets/
│   └── js/
│       └── admin.js               # JavaScript для админ-интерфейса
└── languages/
    ├── slow-plugins-detector.pot # Шаблон переводов
    ├── slow-plugins-detector-ru_RU.po  # Русские переводы
    └── slow-plugins-detector-ru_RU.mo  # Скомпилированные русские переводы
```

## Использование

1. Установите и активируйте плагин
2. Перейдите в Настройки → Slow Plugins Detector
3. Нажмите кнопку "Run Performance Test"
4. Дождитесь завершения тестирования (может занять несколько минут)
5. Изучите результаты в таблице:
   - **Fast** (зеленый): время загрузки < 50мс
   - **Moderate** (желтый): время загрузки 50-100мс
   - **Slow** (красный): время загрузки > 100мс
6. Используйте кнопки "Деактивировать"/"Активировать" в колонке Actions для управления плагинами

## Безопасность

- Проверка прав пользователя (manage_options)
- Валидация и санитизация AJAX-запросов через nonce
- Временная деактивация плагинов только во время тестирования
- Автоматическое восстановление исходного состояния плагинов

## Локализация

Плагин поддерживает переводы. Для добавления нового языка:
1. Скопируйте `slow-plugins-detector.pot` в новый .po файл
2. Переведите строки
3. Скомпилируйте в .mo файл с помощью msgfmt
4. Переименуйте файлы согласно стандарту WordPress (например, для французского: slow-plugins-detector-fr_FR.po/.mo)

## Технические детали

- Использует `wp_remote_get` для измерения времени загрузки страниц
- Деактивирует плагины временно через `update_option('active_plugins', array())`
- Очищает различные типы кешей (WP Cache, W3 Total Cache, WP Super Cache, Endurance Page Cache)
- Выполняет 3 замера для каждого плагина и усредняет результаты
- Совместим с WordPress 4.0+

## Важные замечания

- Тесты выполняются на главной странице сайта
- Каждый плагин тестируется индивидуально для точности измерений
- Результаты могут варьироваться в зависимости от нагрузки сервера и кеширования
- Плагины, помеченные как "Slow", могут нуждаться в оптимизации или замене

## История версий

### 1.1.0
- Добавлены кнопки деактивации/активации плагинов в таблице результатов
- AJAX обработчики для переключения состояния плагинов
- Динамическое обновление состояния кнопок после действий
- Автоматическая очистка кеша после изменения состояния плагинов

### 1.0.0
- Первая версия плагина