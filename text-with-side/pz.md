# Text with Side - Gutenberg Block

## Техническое описание плагина

**Версия:** 2.0.0
**Тип:** WordPress Gutenberg блок
**Назначение:** Создание текстовых блоков с изображениями, которые отображаются на полях основного контента

## Архитектура плагина

### Основные компоненты:

1. **PHP слой (`text-with-side.php`)**
   - Основной класс `TextWithSidePlugin` наследует архитектуру WordPress плагинов
   - Регистрация блока через WordPress API
   - Функция рендеринга для фронтенда
   - Подключение локализации

2. **JavaScript слой (`src/index.js`)**
   - React компонент для редактора Gutenberg
   - Управление состоянием блока через атрибуты
   - Интерфейс пользователя для настроек
   - Валидация и обработка данных

3. **CSS стили**
   - `assets/frontend.css` - стили для публичной части сайта
   - `assets/editor.css` - стили для редактора Gutenberg
   - Responsive дизайн для мобильных устройств

## Принцип работы

### В редакторе (Gutenberg):
1. Блок регистрируется как пользовательский тип `text-with-side/text-with-side`
2. Отображается в области контента с индивидуальными стилями
3. Предоставляет панель настроек в боковой панели редактора
4. Атрибуты блока сохраняются в метаданных WordPress поста

### На фронтенде:
1. PHP функция `render_block()` генерирует HTML на основе сохранённых атрибутов
2. CSS применяет float-позиционирование для размещения блока в полях
3. Блок "выталкивается" за пределы основного контента через отрицательные margin
4. Основной контент обтекает блок за счёт float свойства

## Технические особенности

### Позиционирование блоков:
- **Float-left**: `margin-left: -220px` (блок выходит за левую границу)
- **Float-right**: `margin-right: -220px` (блок выходит за правую границу)
- **Clear**: Предотвращение наложения блоков друг на друга

### Адаптивность:
- На экранах ≤768px: блок становится инлайн (flexbox)
- На экранах ≤480px: блок перестраивается в колонку
- Изображения сохраняют пропорции

### Локализация:
- Поддержка gettext для PHP части
- wp-i18n для JavaScript части
- Автоматическое определение языка WordPress

### Безопасность:
- Проверка `ABSPATH` для предотвращения прямого доступа
- Экранирование вывода через `esc_attr()`, `esc_url()`, `wp_kses_post()`
- Валидация типов данных в атрибутах

## Атрибуты блока

| Атрибут | Тип | По умолчанию | Описание |
|---------|-----|--------------|----------|
| `content` | string | '' | Текстовое содержимое блока |
| `imageId` | number | 0 | ID изображения в медиатеке WordPress |
| `imageUrl` | string | '' | URL изображения |
| `imageAlt` | string | '' | Альтернативный текст изображения |
| `position` | string | 'left' | Позиция блока (left/right) |
| `imageLink` | string | 'none' | Тип ссылки (none/media/attachment) |
| `width` | string | '150px' | Ширина изображения |

## Файловая структура

```
text-with-side/
├── text-with-side.php          # Основной файл плагина
├── src/index.js                # JavaScript код блока
├── package.json                # Конфигурация сборки
├── assets/
│   ├── frontend.css            # Стили фронтенда
│   └── editor.css              # Стили редактора
├── languages/                  # Файлы переводов
│   ├── text-with-side.pot      # Шаблон переводов
│   ├── text-with-side-ru_RU.*  # Русская локализация
│   └── text-with-side-en_US.*  # Английская локализация
├── build/                      # Собранные файлы
└── documentation/              # Документация
```

## Интеграция с WordPress

- **Хук `init`**: Регистрация блока при инициализации WordPress
- **Хук `wp_enqueue_scripts`**: Подключение стилей фронтенда
- **Хук `enqueue_block_editor_assets`**: Подключение ресурсов редактора
- **Хук `init`**: Загрузка текстового домена для переводов

Этот плагин демонстрирует современный подход к созданию Gutenberg блоков с использованием лучших практик WordPress разработки.