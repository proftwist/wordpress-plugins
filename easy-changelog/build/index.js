(()=>{"use strict";const e=window.wp.blocks,a=window.wp.i18n,s=window.wp.element,n=window.wp.components,t=window.wp.blockEditor,l=window.ReactJSXRuntime;(0,e.registerBlockType)("easy-changelog/changelog",{title:(0,a.__)("Easy Changelog","easy-changelog"),description:(0,a.__)("Display a beautiful changelog with JSON data","easy-changelog"),category:"widgets",icon:"list-view",supports:{html:!1},attributes:{changelogData:{type:"string",default:'[\n    {\n        "version": "1.0.0",\n        "date": "2024-01-15",\n        "added": [\n            "Initial release of the plugin",\n            "Basic changelog functionality",\n            "Gutenberg block integration"\n        ]\n    },\n    {\n        "version": "1.1.0",\n        "date": "2024-01-20",\n        "added": [\n            "Added preview tab",\n            "Improved styling",\n            "JSON validation"\n        ]\n    }\n]'}},edit:({attributes:e,setAttributes:i})=>{const{changelogData:o}=e,[c,g]=(0,s.useState)(""),[r,d]=(0,s.useState)([]),h=(0,t.useBlockProps)();(0,s.useEffect)(()=>{try{if(o.trim()){const e=JSON.parse(o);Array.isArray(e)?(d(e),g("")):g((0,a.__)("JSON must be an array","easy-changelog"))}else d([]),g("")}catch(e){g((0,a.__)("Invalid JSON format","easy-changelog")),d([])}},[o]);const y=[{name:"json",title:(0,a.__)("JSON Editor","easy-changelog"),className:"easy-changelog-json-tab"},{name:"preview",title:(0,a.__)("Preview","easy-changelog"),className:"easy-changelog-preview-tab"}],m=e=>{if(!e||"No date"===e)return e;const a=new Date(e);return isNaN(a.getTime())?e:`${a.getDate().toString().padStart(2,"0")}.${(a.getMonth()+1).toString().padStart(2,"0")}.${a.getFullYear()}`};return(0,l.jsxs)("div",{...h,children:[(0,l.jsx)(t.InspectorControls,{children:(0,l.jsx)(n.PanelBody,{title:(0,a.__)("Changelog Settings","easy-changelog"),initialOpen:!0,children:(0,l.jsx)("p",{children:(0,a.__)("Use the JSON Editor tab to input your changelog data in JSON format.","easy-changelog")})})}),(0,l.jsx)("div",{className:"easy-changelog-editor",children:(0,l.jsx)(n.TabPanel,{className:"easy-changelog-tabs",activeClass:"is-active",onSelect:()=>{},tabs:y,children:e=>(0,l.jsxs)("div",{className:"easy-changelog-tab-content",children:["json"===e.name&&(0,l.jsxs)("div",{className:"easy-changelog-json-editor",children:[c&&(0,l.jsx)(n.Notice,{status:"error",isDismissible:!1,children:c}),(0,l.jsx)(n.TextareaControl,{label:(0,a.__)("Changelog JSON","easy-changelog"),help:(0,a.__)("Enter valid JSON array with version, date, and added fields","easy-changelog"),value:o,onChange:e=>i({changelogData:e}),rows:20,className:"easy-changelog-textarea"})]}),"preview"===e.name&&(0,l.jsx)("div",{className:"easy-changelog-preview",children:c?(0,l.jsx)(n.Notice,{status:"warning",isDismissible:!1,children:(0,a.__)("Fix JSON errors to see preview","easy-changelog")}):0===r.length?(0,l.jsx)(n.Notice,{status:"info",isDismissible:!1,children:(0,a.__)("No changelog data to display","easy-changelog")}):(0,l.jsxs)("div",{className:"easy-changelog-block",children:[(0,l.jsx)("h3",{className:"easy-changelog-title",children:(0,a.__)("Changelog","easy-changelog")}),(0,l.jsx)("div",{className:"easy-changelog-list",children:r.map((e,s)=>(0,l.jsxs)("div",{className:"easy-changelog-release",children:[(0,l.jsxs)("div",{className:"easy-changelog-header",children:[(0,l.jsx)("span",{className:"easy-changelog-version",children:e.version||"No version"}),(0,l.jsx)("span",{className:"easy-changelog-date",children:m(e.date||"No date")})]}),e.added&&e.added.length>0&&(0,l.jsxs)("div",{className:"easy-changelog-section",children:[(0,l.jsx)("h4",{className:"easy-changelog-section-title",children:(0,a.__)("Added","easy-changelog")}),(0,l.jsx)("ul",{className:"easy-changelog-items",children:e.added.map((e,a)=>(0,l.jsx)("li",{className:"easy-changelog-item",children:e},a))})]})]},s))})]})})]})})})]})},save:()=>null})})();