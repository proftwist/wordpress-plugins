(()=>{"use strict";const e=window.wp.blocks,a=window.wp.i18n,n=window.wp.element,s=window.wp.components,t=window.wp.blockEditor,l=window.ReactJSXRuntime;!function(){try{const e=window.wp&&window.wp.i18n?window.wp.i18n.getLocaleData("easy-changelog"):null;if(e)(0,a.setLocaleData)(e,"easy-changelog");else{if(((window.wp&&window.wp.i18n?window.wp.i18n.getLocaleData():{}).locale||"en_US").startsWith("ru")){const e={"":{domain:"easy-changelog",lang:"ru_RU","plural-forms":"nplurals=3; plural=(n%10==1 && n%100!=11 ? 0 : n%10>=2 && n%10<=4 && (n%100<12 || n%100>14) ? 1 : 2);"},"Easy Changelog":["Легкий Чейнджлог"],"Display a beautiful changelog with JSON data":["Отображение красивого чейнджлога с данными JSON"],Changelog:["История изменений"],Added:["Добавлено"],"JSON Editor":["Редактор JSON"],Preview:["Предпросмотр"],"Changelog JSON":["JSON чейнджлога"],"Enter valid JSON array with version, date, and added fields":["Введите валидный массив JSON с полями version, date и added"],"Invalid JSON format":["Неверный формат JSON"],"JSON must be an array":["JSON должен быть массивом"],"Fix JSON errors to see preview":["Исправьте ошибки JSON для просмотра"],"No changelog data to display":["Нет данных чейнджлога для отображения"],"Changelog Settings":["Настройки чейнджлога"],"Use the JSON Editor tab to input your changelog data in JSON format.":["Используйте вкладку редактора JSON для ввода данных чейнджлога в формате JSON."],"Invalid changelog data":["Неверные данные чейнджлога"]};(0,a.setLocaleData)(e,"easy-changelog")}else{const e={"":{domain:"easy-changelog",lang:"en_US","plural-forms":"nplurals=2; plural=(n != 1);"},"Easy Changelog":["Easy Changelog"],"Display a beautiful changelog with JSON data":["Display a beautiful changelog with JSON data"],Changelog:["Changelog"],Added:["Added"],"JSON Editor":["JSON Editor"],Preview:["Preview"],"Changelog JSON":["Changelog JSON"],"Enter valid JSON array with version, date, and added fields":["Enter valid JSON array with version, date, and added fields"],"Invalid JSON format":["Invalid JSON format"],"JSON must be an array":["JSON must be an array"],"Fix JSON errors to see preview":["Fix JSON errors to see preview"],"No changelog data to display":["No changelog data to display"],"Changelog Settings":["Changelog Settings"],"Use the JSON Editor tab to input your changelog data in JSON format.":["Use the JSON Editor tab to input your changelog data in JSON format."],"Invalid changelog data":["Invalid changelog data"]};(0,a.setLocaleData)(e,"easy-changelog")}}}catch(e){console.warn("Easy Changelog: Failed to load translations",e)}}(),(0,e.registerBlockType)("easy-changelog/changelog",{title:(0,a.__)("Easy Changelog","easy-changelog"),description:(0,a.__)("Display a beautiful changelog with JSON data","easy-changelog"),category:"widgets",icon:"list-view",supports:{html:!1},attributes:{changelogData:{type:"string",default:'[\n    {\n        "version": "1.0.0",\n        "date": "15.01.2024",\n        "added": [\n            "Initial release of the plugin",\n            "Basic changelog functionality",\n            "Gutenberg block integration"\n        ]\n    },\n    {\n        "version": "1.1.0",\n        "date": "20.01.2024",\n        "added": [\n            "Added preview tab",\n            "Improved styling",\n            "JSON validation"\n        ]\n    }\n]'}},edit:({attributes:e,setAttributes:i})=>{const{changelogData:o}=e,[g,d]=(0,n.useState)(""),[r,c]=(0,n.useState)([]),h=(0,t.useBlockProps)();(0,n.useEffect)(()=>{try{if(o.trim()){const e=JSON.parse(o);Array.isArray(e)?(c(e),d("")):d((0,a.__)("JSON must be an array","easy-changelog"))}else c([]),d("")}catch(e){d((0,a.__)("Invalid JSON format","easy-changelog")),c([])}},[o]);const N=[{name:"json",title:(0,a.__)("JSON Editor","easy-changelog"),className:"easy-changelog-json-tab"},{name:"preview",title:(0,a.__)("Preview","easy-changelog"),className:"easy-changelog-preview-tab"}],y=e=>{if(!e||"No date"===e)return e;const a=new Date(e);return isNaN(a.getTime())?e:`${a.getDate().toString().padStart(2,"0")}.${(a.getMonth()+1).toString().padStart(2,"0")}.${a.getFullYear()}`};return(0,l.jsxs)("div",{...h,children:[(0,l.jsx)(t.InspectorControls,{children:(0,l.jsx)(s.PanelBody,{title:(0,a.__)("Changelog Settings","easy-changelog"),initialOpen:!0,children:(0,l.jsx)("p",{children:(0,a.__)("Use the JSON Editor tab to input your changelog data in JSON format.","easy-changelog")})})}),(0,l.jsx)("div",{className:"easy-changelog-editor",children:(0,l.jsx)(s.TabPanel,{className:"easy-changelog-tabs",activeClass:"is-active",onSelect:()=>{},tabs:N,children:e=>(0,l.jsxs)("div",{className:"easy-changelog-tab-content",children:["json"===e.name&&(0,l.jsxs)("div",{className:"easy-changelog-json-editor",children:[g&&(0,l.jsx)(s.Notice,{status:"error",isDismissible:!1,children:g}),(0,l.jsx)(s.TextareaControl,{label:(0,a.__)("Changelog JSON","easy-changelog"),help:(0,a.__)("Enter valid JSON array with version, date, and added fields","easy-changelog"),value:o,onChange:e=>i({changelogData:e}),rows:20,className:"easy-changelog-textarea"})]}),"preview"===e.name&&(0,l.jsx)("div",{className:"easy-changelog-preview",children:g?(0,l.jsx)(s.Notice,{status:"warning",isDismissible:!1,children:(0,a.__)("Fix JSON errors to see preview","easy-changelog")}):0===r.length?(0,l.jsx)(s.Notice,{status:"info",isDismissible:!1,children:(0,a.__)("No changelog data to display","easy-changelog")}):(0,l.jsxs)("div",{className:"easy-changelog-block",children:[(0,l.jsx)("h3",{className:"easy-changelog-title",children:(0,a.__)("Changelog","easy-changelog")}),(0,l.jsx)("div",{className:"easy-changelog-list",children:r.map((e,n)=>(0,l.jsxs)("div",{className:"easy-changelog-release",children:[(0,l.jsxs)("div",{className:"easy-changelog-header",children:[(0,l.jsx)("span",{className:"easy-changelog-version",children:e.version||"No version"}),(0,l.jsx)("span",{className:"easy-changelog-date",children:y(e.date||"No date")})]}),e.added&&e.added.length>0&&(0,l.jsxs)("div",{className:"easy-changelog-section",children:[(0,l.jsx)("h4",{className:"easy-changelog-section-title",children:(0,a.__)("Added","easy-changelog")}),(0,l.jsx)("ul",{className:"easy-changelog-items",children:e.added.map((e,a)=>(0,l.jsx)("li",{className:"easy-changelog-item",children:e},a))})]})]},n))})]})})]})})})]})},save:()=>null})})();