(()=>{"use strict";const e=window.wp.blocks,a=window.wp.i18n,t=window.React,n=window.wp.element,s=window.wp.components,l=window.wp.blockEditor;(0,e.registerBlockType)("easy-changelog/changelog",{title:(0,a.__)("Easy Changelog","easy-changelog"),description:(0,a.__)("Display a beautiful changelog with JSON data","easy-changelog"),category:"widgets",icon:"list-view",supports:{html:!1},attributes:{changelogData:{type:"string",default:'[\n    {\n        "version": "1.0.0",\n        "date": "2024-01-15",\n        "added": [\n            "Initial release of the plugin",\n            "Basic changelog functionality",\n            "Gutenberg block integration"\n        ]\n    },\n    {\n        "version": "1.1.0",\n        "date": "2024-01-20",\n        "added": [\n            "Added preview tab",\n            "Improved styling",\n            "JSON validation"\n        ]\n    }\n]'}},edit:({attributes:e,setAttributes:c})=>{const{changelogData:o}=e,[i,g]=(0,n.useState)(""),[r,d]=(0,n.useState)([]),m=(0,l.useBlockProps)();(0,n.useEffect)(()=>{try{if(o.trim()){const e=JSON.parse(o);Array.isArray(e)?(d(e),g("")):g((0,a.__)("JSON must be an array","easy-changelog"))}else d([]),g("")}catch(e){g((0,a.__)("Invalid JSON format","easy-changelog")),d([])}},[o]);const h=[{name:"json",title:(0,a.__)("JSON Editor","easy-changelog"),className:"easy-changelog-json-tab"},{name:"preview",title:(0,a.__)("Preview","easy-changelog"),className:"easy-changelog-preview-tab"}];return(0,t.createElement)("div",{...m},(0,t.createElement)(l.InspectorControls,null,(0,t.createElement)(s.PanelBody,{title:(0,a.__)("Changelog Settings","easy-changelog"),initialOpen:!0},(0,t.createElement)("p",null,(0,a.__)("Use the JSON Editor tab to input your changelog data in JSON format.","easy-changelog")))),(0,t.createElement)("div",{className:"easy-changelog-editor"},(0,t.createElement)(s.TabPanel,{className:"easy-changelog-tabs",activeClass:"is-active",onSelect:()=>{},tabs:h},e=>(0,t.createElement)("div",{className:"easy-changelog-tab-content"},"json"===e.name&&(0,t.createElement)("div",{className:"easy-changelog-json-editor"},i&&(0,t.createElement)(s.Notice,{status:"error",isDismissible:!1},i),(0,t.createElement)(s.TextareaControl,{label:(0,a.__)("Changelog JSON","easy-changelog"),help:(0,a.__)("Enter valid JSON array with version, date, and added fields","easy-changelog"),value:o,onChange:e=>c({changelogData:e}),rows:20,className:"easy-changelog-textarea"})),"preview"===e.name&&(0,t.createElement)("div",{className:"easy-changelog-preview"},i?(0,t.createElement)(s.Notice,{status:"warning",isDismissible:!1},(0,a.__)("Fix JSON errors to see preview","easy-changelog")):0===r.length?(0,t.createElement)(s.Notice,{status:"info",isDismissible:!1},(0,a.__)("No changelog data to display","easy-changelog")):(0,t.createElement)("div",{className:"easy-changelog-block"},(0,t.createElement)("h3",{className:"easy-changelog-title"},(0,a.__)("Changelog","easy-changelog")),(0,t.createElement)("div",{className:"easy-changelog-list"},r.map((e,n)=>(0,t.createElement)("div",{key:n,className:"easy-changelog-release"},(0,t.createElement)("div",{className:"easy-changelog-header"},(0,t.createElement)("span",{className:"easy-changelog-version"},e.version||"No version"),(0,t.createElement)("span",{className:"easy-changelog-date"},e.date||"No date")),e.added&&e.added.length>0&&(0,t.createElement)("div",{className:"easy-changelog-section"},(0,t.createElement)("h4",{className:"easy-changelog-section-title"},(0,a.__)("Added","easy-changelog")),(0,t.createElement)("ul",{className:"easy-changelog-items"},e.added.map((e,a)=>(0,t.createElement)("li",{key:a,className:"easy-changelog-item"},e)))))))))))))},save:()=>null})})();